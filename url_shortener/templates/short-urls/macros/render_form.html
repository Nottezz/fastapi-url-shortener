{% from "macros/form-fields.html" import form_field %}

{% macro render_form(action, button_text) %}

<div class="card-body p-4">

  <form action="{{ action }}" method="post" novalidate>

    {% for field_name, field_schema in model_schema.properties.items() %}
      {% set is_required = field_name in (model_schema.get("required") or []) %}

      {{ form_field(
          field_name=field_name,
          field_schema=field_schema,
          is_required=is_required,
          validated=form_validated,
          error=errors and errors.get(field_name),
          value=form_data and form_data.get(field_name) or field_schema.default
      ) }}

    {% endfor %}

    <div class="d-grid mt-4">
      <button type="submit" class="btn bg-dark text-white btn-lg shadow-sm">
        <i class="bi bi-check-circle me-1"></i>
        {{ button_text }}
      </button>

      <a href="{{ url_for('short-url:list-view') }}"
         class="btn btn-outline-secondary mt-3">
        <i class="bi bi-arrow-left me-1"></i>
        Back to URL list
      </a>
    </div>

  </form>

</div>

{% endmacro %}
